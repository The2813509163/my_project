08/26 14:52:19 - OpenCompass - INFO - Task [Llama-3.2-3B_hf/gsm8k_0,Llama-3.2-3B_hf/math_0,Llama-3.2-3B_hf/svamp_0,Llama-3.2-3B_hf/piqa_0,Llama-3.2-3B_hf/siqa_0,Llama-3.2-3B_hf/squad2.0_0,Llama-3.2-3B_hf/ARC-c_0,Llama-3.2-3B_hf/ARC-e_0,Llama-3.2-3B_hf/lambada_0]
08/26 14:52:21 - OpenCompass - WARNING - pad_token_id is not set for the tokenizer.
08/26 14:52:21 - OpenCompass - WARNING - Using eos_token_id 128001 as pad_token_id.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.09it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.85it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.68it/s]
08/26 14:52:25 - OpenCompass - INFO - Try to load the data from /data/kris/shared_data/datasets/NLP/opencompass/./data/gsm8k/
gsm8k_0 train 7473
gsm8k_0 test 1319
08/26 14:52:26 - OpenCompass - INFO - Start inferencing [Llama-3.2-3B_hf/gsm8k_0]
[2025-08-26 14:52:26,139] [opencompass.openicl.icl_inferencer.icl_gen_inferencer] [INFO] Starting build dataloader
[2025-08-26 14:52:26,140] [opencompass.openicl.icl_inferencer.icl_gen_inferencer] [INFO] Starting inference process...
  0%|          | 0/11 [00:00<?, ?it/s]/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:631: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:636: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  9%|▉         | 1/11 [00:30<05:08, 30.81s/it] 18%|█▊        | 2/11 [01:00<04:31, 30.12s/it] 27%|██▋       | 3/11 [01:30<04:01, 30.22s/it] 36%|███▋      | 4/11 [02:00<03:31, 30.14s/it] 36%|███▋      | 4/11 [02:01<03:32, 30.31s/it]
Traceback (most recent call last):
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/opencompass/tasks/openicl_infer.py", line 161, in <module>
    inferencer.run()
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/opencompass/tasks/openicl_infer.py", line 89, in run
    self._inference()
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/opencompass/tasks/openicl_infer.py", line 134, in _inference
    inferencer.inference(retriever,
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/opencompass/openicl/icl_inferencer/icl_gen_inferencer.py", line 153, in inference
    results = self.model.generate_from_template(
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/opencompass/models/base.py", line 201, in generate_from_template
    return self.generate(inputs, max_out_len=max_out_len, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/opencompass/models/huggingface_above_v4_33.py", line 583, in generate
    outputs = self.model.generate(**tokens, **generation_kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/peft/peft_model.py", line 1874, in generate
    outputs = self.base_model.generate(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/transformers/generation/utils.py", line 2463, in generate
    result = self._sample(
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/transformers/generation/utils.py", line 3429, in _sample
    outputs = self(**model_inputs, return_dict=True)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/transformers/utils/generic.py", line 965, in wrapper
    output = func(self, *args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 821, in forward
    outputs: BaseModelOutputWithPast = self.model(
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/transformers/utils/generic.py", line 965, in wrapper
    output = func(self, *args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 571, in forward
    layer_outputs = decoder_layer(
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 318, in forward
    hidden_states, self_attn_weights = self.self_attn(
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 254, in forward
    value_states = self.v_proj(hidden_states).view(hidden_shape).transpose(1, 2)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/peft/tuners/lora/layer.py", line 724, in forward
    x = self._cast_input_dtype(x, lora_A.weight.dtype)
  File "/home/kris/miniconda3/envs/opencompass-official/lib/python3.10/site-packages/peft/tuners/lora/layer.py", line 508, in _cast_input_dtype
    return x.to(dtype=dtype)
KeyboardInterrupt
